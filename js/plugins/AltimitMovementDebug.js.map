{"version":3,"file":"AltimitMovementDebug.js","sourceRoot":"","sources":["../../../src/AltimitMovementDebug.ts"],"names":[],"mappings":"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","sourcesContent":["/*\r\n * MIT License\r\n *\r\n * Copyright (c) 2017 Altimit Community Contributors\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n * SOFTWARE.\r\n */\r\n\r\n//=============================================================================\r\n// AltimitMovementDebug.js\r\n// Based on https://github.com/AltimitSystems/mv-plugins/tree/master/movement-debug\r\n//=============================================================================\r\n// Ve Lee\r\n// Compatibility with mz\r\n// Add plugin command and F11 to switch debug layer\r\n/*:\r\n * @target MZ\r\n * @plugindesc Debug display layer for AltimitMovement\r\n * @author Altimit Community Contributors\r\n *\r\n * @param default_display\r\n * @text Default display\r\n * @type boolean\r\n * @on Yes\r\n * @off No\r\n * @default true\r\n *\r\n * Usage:\r\n *  Requires Altimit Movement (https://github.com/AltimitSystems/mv-plugins/tree/master/movement).\r\n *  Plugin will automatically apply when ON.\r\n *\r\n * @command switchDebug\r\n * @text Show/hide debug layer\r\n * @desc Show/hide debug layer\r\n *\r\n * About:\r\n *  Version 0.01 Alpha\r\n *  Website https://github.com/AltimitSystems/mv-plugins/tree/master/movement-debug\r\n */\r\n(function () {\r\n  const pluginName = 'AltimitMovementDebug';\r\n  const default_display =\r\n    PluginManager.parameters(pluginName)['default_display'];\r\n  let DEBUG_DISPLAY = default_display !== 'false';\r\n\r\n  function swithDebug() {\r\n    if (!(SceneManager._scene instanceof Scene_Map)) return;\r\n    if (!$gameTemp._vectorDebugVisible) {\r\n      const sceneMap = SceneManager._scene;\r\n      sceneMap._spriteset.addChild(sceneMap._spriteset._vectorDebugLayer);\r\n      $gameTemp._vectorDebugVisible = true;\r\n    } else {\r\n      const sceneMap = SceneManager._scene;\r\n      sceneMap._spriteset.removeChild(sceneMap._spriteset._vectorDebugLayer);\r\n      $gameTemp._vectorDebugVisible = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Game_CharacterBase\r\n   */\r\n\r\n  Game_CharacterBase.prototype.screenOriginX = function () {\r\n    const tw = $gameMap.tileWidth();\r\n    return Math.round(this.scrolledX() * tw);\r\n  };\r\n\r\n  Game_CharacterBase.prototype.screenOriginY = function () {\r\n    const th = $gameMap.tileHeight();\r\n    return Math.round(this.scrolledY() * th);\r\n  };\r\n\r\n  /**\r\n   * Spriteset_Map\r\n   */\r\n\r\n  /**\r\n   * Overrides\r\n   */\r\n\r\n  const Spriteset_Map_createUpperLayer =\r\n    Spriteset_Map.prototype.createUpperLayer;\r\n  Spriteset_Map.prototype.createUpperLayer = function () {\r\n    Spriteset_Map_createUpperLayer.call(this);\r\n    this.createVectorDebugLayer();\r\n  };\r\n\r\n  const SceneManager_onKeyDown = SceneManager.onKeyDown;\r\n  SceneManager.onKeyDown = function (event) {\r\n    if (!event.ctrlKey && !event.altKey) {\r\n      switch (event.keyCode) {\r\n        case 122: // F11\r\n          swithDebug();\r\n          break;\r\n      }\r\n    }\r\n    SceneManager_onKeyDown.call(this, event);\r\n  };\r\n\r\n  /**\r\n   * Debug_Layer\r\n   */\r\n\r\n  class VectorDebugLayer extends Sprite {\r\n    bitmap: Bitmap;\r\n\r\n    constructor() {\r\n      super();\r\n      Sprite.prototype.initialize.call(this);\r\n      this.bitmap = new Bitmap(Graphics.width, Graphics.height);\r\n      this.opacity = 192;\r\n    }\r\n\r\n    update() {\r\n      this.bitmap.clearRect(0, 0, this.bitmap.width, this.bitmap.height);\r\n      if (!$gameMap.collisionMesh) {\r\n        return;\r\n      }\r\n\r\n      const tileWidth = $gameMap.tileWidth();\r\n      const tileHeight = $gameMap.tileHeight();\r\n      const bitmap = this.bitmap;\r\n\r\n      let mapX = $gameMap.adjustX(0) * tileWidth;\r\n      let mapY = $gameMap.adjustY(0) * tileHeight;\r\n      mapX = Math.floor(mapX);\r\n      mapY = Math.floor(mapY);\r\n      bitmap.drawCollider(\r\n        mapX + 0.5,\r\n        mapY + 0.5,\r\n        $gameMap.collisionMesh($gamePlayer._collisionType),\r\n      );\r\n      bitmap.drawCollider(\r\n        mapX - $gameMap.width() * tileWidth + 0.5,\r\n        mapY + 0.5,\r\n        $gameMap.collisionMesh($gamePlayer._collisionType),\r\n      );\r\n      bitmap.drawCollider(\r\n        mapX + 0.5,\r\n        mapY - $gameMap.height() * tileHeight + 0.5,\r\n        $gameMap.collisionMesh($gamePlayer._collisionType),\r\n      );\r\n      bitmap.drawCollider(\r\n        mapX - $gameMap.width() * tileWidth + 0.5,\r\n        mapY - $gameMap.height() * tileHeight + 0.5,\r\n        $gameMap.collisionMesh($gamePlayer._collisionType),\r\n      );\r\n\r\n      $gameMap.characters().forEach(function (character) {\r\n        if (\r\n          !character ||\r\n          character._transparent ||\r\n          ((character as Game_Follower).isVisible &&\r\n            !(character as Game_Follower).isVisible())\r\n        ) {\r\n          return;\r\n        }\r\n        bitmap.drawCollider(\r\n          character.screenOriginX() + 0.5,\r\n          character.screenOriginY() + 0.5,\r\n          character.collider(),\r\n        );\r\n      });\r\n    }\r\n  }\r\n\r\n  Spriteset_Map.prototype.createVectorDebugLayer = function () {\r\n    this._vectorDebugLayer = new VectorDebugLayer();\r\n    this._vectorDebugLayer.opacity = 128;\r\n    if (DEBUG_DISPLAY && !$gameTemp._vectorDebugVisible) {\r\n      $gameTemp._vectorDebugVisible = true;\r\n      DEBUG_DISPLAY = false;\r\n    }\r\n    if ($gameTemp._vectorDebugVisible) {\r\n      this.addChild(this._vectorDebugLayer);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Bitmap\r\n   */\r\n\r\n  /**\r\n   * Extension\r\n   */\r\n\r\n  Bitmap.prototype.drawCollider = function (x, y, collider) {\r\n    if (!(collider && collider.aabbox)) return;\r\n    const tw = $gameMap.tileWidth();\r\n    const th = $gameMap.tileHeight();\r\n\r\n    if (x + collider.aabbox.right * tw < 0) {\r\n      return;\r\n    }\r\n    if (y + collider.aabbox.bottom * th < 0) {\r\n      return;\r\n    }\r\n    if (x + collider.aabbox.left * tw > Graphics.width) {\r\n      return;\r\n    }\r\n    if (y + collider.aabbox.top * th > Graphics.height) {\r\n      return;\r\n    }\r\n\r\n    const context = this.context;\r\n\r\n    //if Collider.LIST\r\n    if (collider.type == 2) {\r\n      if (!collider.colliders) return;\r\n      context.save();\r\n      context.lineWidth = 1;\r\n      context.strokeStyle = 'yellow';\r\n      context.strokeRect(\r\n        x + collider.aabbox.left * tw,\r\n        y + collider.aabbox.top * th,\r\n        (collider.aabbox.right - collider.aabbox.left) * tw,\r\n        (collider.aabbox.bottom - collider.aabbox.top) * th,\r\n      );\r\n      context.restore();\r\n\r\n      collider.colliders.forEach((collider) => {\r\n        this.drawCollider(x, y, collider);\r\n      });\r\n      return;\r\n    }\r\n\r\n    context.save();\r\n    context.lineWidth = 1;\r\n    context.strokeStyle = 'green';\r\n    context.strokeRect(\r\n      x + collider.aabbox.left * tw,\r\n      y + collider.aabbox.top * th,\r\n      (collider.aabbox.right - collider.aabbox.left) * tw,\r\n      (collider.aabbox.bottom - collider.aabbox.top) * th,\r\n    );\r\n    context.restore();\r\n\r\n    context.save();\r\n    context.lineWidth = 1;\r\n    context.strokeStyle = 'blue';\r\n    context.beginPath();\r\n    //Collider.CIRCLE\r\n    if (collider.type == 0) {\r\n      if (!(collider.x && collider.y && collider.radius)) return;\r\n      // Circle type\r\n      context.arc(\r\n        x + collider.x * tw,\r\n        y + collider.y * th,\r\n        (collider.radius * (tw + th)) / 2,\r\n        0,\r\n        Math.PI * 2,\r\n        false,\r\n      );\r\n    } else if (collider.type == 1) {\r\n      //Collider.POLYGON\r\n      if (!collider.vertices) return;\r\n      context.moveTo(\r\n        x + collider.vertices[0][0] * tw,\r\n        y + collider.vertices[0][1] * th,\r\n      );\r\n      for (let ii = 1; ii < collider.vertices.length; ii++) {\r\n        context.lineTo(\r\n          x + collider.vertices[ii][0] * tw,\r\n          y + collider.vertices[ii][1] * th,\r\n        );\r\n      }\r\n      context.lineTo(\r\n        x + collider.vertices[0][0] * tw,\r\n        y + collider.vertices[0][1] * th,\r\n      );\r\n    }\r\n    context.stroke();\r\n    context.restore();\r\n\r\n    //Collider.POLYGON\r\n    if (collider.type == 1) {\r\n      if (!collider.vertices) return;\r\n      let jj;\r\n      for (let ii = 0; ii < collider.vertices.length; ii++) {\r\n        jj = ii + 1;\r\n        if (jj == collider.vertices.length) {\r\n          jj = 0;\r\n        }\r\n\r\n        let nx = collider.vertices[jj][1] - collider.vertices[ii][1]; // -DY\r\n        let ny = collider.vertices[ii][0] - collider.vertices[jj][0]; // +DX\r\n        const length = Math.sqrt(nx * nx + ny * ny);\r\n        nx /= length;\r\n        ny /= length;\r\n        let ox = (collider.vertices[jj][0] + collider.vertices[ii][0]) / 2;\r\n        let oy = (collider.vertices[jj][1] + collider.vertices[ii][1]) / 2;\r\n\r\n        context.save();\r\n        context.lineWidth = 1;\r\n        context.strokeStyle = 'red';\r\n        context.beginPath();\r\n        context.moveTo(x + ox * tw, y + oy * th);\r\n        ox += nx * 0.25;\r\n        oy += ny * 0.25;\r\n        context.lineTo(x + ox * tw, y + oy * th);\r\n        context.stroke();\r\n        context.restore();\r\n      }\r\n    }\r\n\r\n    //   this._setDirty();\r\n  };\r\n\r\n  PluginManager.registerCommand(pluginName, 'switchDebug', swithDebug);\r\n})();\r\n"]}